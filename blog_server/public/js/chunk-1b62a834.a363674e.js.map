{"version":3,"sources":["webpack:///./node_modules/core-js/internals/array-method-has-species-support.js","webpack:///./src/views/Message/index.vue?c43a","webpack:///./src/views/Message/index.vue?bc0f","webpack:///./src/api/messageService.js","webpack:///src/views/Message/index.vue","webpack:///./src/views/Message/index.vue?a5ce","webpack:///./src/views/Message/index.vue","webpack:///./src/components/RichText.vue?85e7","webpack:///src/components/RichText.vue","webpack:///./src/components/RichText.vue?535d","webpack:///./src/components/RichText.vue","webpack:///./node_modules/core-js/modules/es.array.map.js"],"names":["fails","wellKnownSymbol","V8_VERSION","SPECIES","module","exports","METHOD_NAME","array","constructor","foo","Boolean","render","_vm","this","_h","$createElement","_c","_self","attrs","staticClass","_m","on","submitMessage","_l","item","index","key","_id","style","user","avatar","_v","_s","username","domProps","content","_f","date","$event","replyClick","reply","lastIndexArr","undefined","childItem","childIndex","Math","random","atUserName","class","ifShow","directives","name","rawName","value","expression","target","composing","$set","submitSubMessage","currentPage","total","handleSizeChange","handleCurrentChange","staticRenderFns","addMessage","data","request","post","addSubMessage","getMessageList","skip","limit","get","params","getCountMessage","component","staticStyle","handleSubmit","$","$map","map","arrayMethodHasSpeciesSupport","arrayMethodUsesToLength","HAS_SPECIES_SUPPORT","USES_TO_LENGTH","proto","forced","callbackfn","arguments","length"],"mappings":"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","file":"js/chunk-1b62a834.a363674e.js","sourcesContent":["var fails = require('../internals/fails');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar V8_VERSION = require('../internals/engine-v8-version');\n\nvar SPECIES = wellKnownSymbol('species');\n\nmodule.exports = function (METHOD_NAME) {\n  // We can't use this feature detection in V8 since it causes\n  // deoptimization and serious performance degradation\n  // https://github.com/zloirock/core-js/issues/677\n  return V8_VERSION >= 51 || !fails(function () {\n    var array = [];\n    var constructor = array.constructor = {};\n    constructor[SPECIES] = function () {\n      return { foo: 1 };\n    };\n    return array[METHOD_NAME](Boolean).foo !== 1;\n  });\n};\n","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=be574686&lang=less&scoped=true&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=be574686&lang=less&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"message\"}},[_c('Nav'),_c('div',{staticClass:\"message-main\"},[_c('div',{staticClass:\"message-edit\"},[_vm._m(0),_c('RichText',{on:{\"Sub\":_vm.submitMessage}})],1),_c('ul',{staticClass:\"message-list\"},_vm._l((_vm.commentList),function(item,index){return _c('li',{key:item._id,staticClass:\"message-item\"},[_c('div',{staticClass:\"p-u-info\"},[_c('span',{staticClass:\"img\",style:({'backgroundImage': 'url('+item.user.avatar+')'})}),_c('span',{staticClass:\"user\"},[_vm._v(_vm._s(item.user.username))])]),_c('div',{staticClass:\"content\"},[_c('div',{staticClass:\"text\",domProps:{\"innerHTML\":_vm._s(item.content)}}),_c('div',{staticClass:\"time\"},[_c('span',[_vm._v(_vm._s(_vm._f(\"getTime\")(item.date)))]),_c('a',{attrs:{\"href\":\"javascript:;\"},on:{\"click\":function($event){return _vm.replyClick(index)}}},[_vm._v(\" \"+_vm._s((item.reply.lastIndexArr[0]===index && item.reply.lastIndexArr[1]===undefined)?\"收起\":\"回复\")+\" \")])])]),_c('ul',{staticClass:\"sub-list\"},_vm._l((item.children),function(childItem,childIndex){return _c('li',{key:childIndex+Math.random()*100,staticClass:\"sub-item\"},[_c('div',{staticClass:\"img\",style:({'backgroundImage': 'url('+childItem.user.avatar+')'})}),_c('div',{staticClass:\"content\"},[_c('div',[_c('span',{staticClass:\"name\"},[_vm._v(_vm._s(childItem.user.username))]),_c('span',[_vm._v(\"回复\")]),_c('span',{staticClass:\"name\"},[_vm._v(_vm._s(childItem.atUserName))]),_c('span',{staticClass:\"content\"},[_vm._v(_vm._s(childItem.content))])]),_c('div',[_c('span',{staticClass:\"time\"},[_vm._v(_vm._s(_vm._f(\"getTime\")(childItem.date)))]),_c('a',{attrs:{\"href\":\"javascript:;\"},on:{\"click\":function($event){return _vm.replyClick(index,childIndex)}}},[_vm._v(\" \"+_vm._s((item.reply.lastIndexArr[0]===index && item.reply.lastIndexArr[1]===childIndex)?\"收起\":\"回复\")+\" \")])])])])}),0),_c('div',{class:['reply',{'show': item.reply.ifShow}]},[_c('textarea',{directives:[{name:\"model\",rawName:\"v-model\",value:(item.reply.content),expression:\"item.reply.content\"}],attrs:{\"placeholder\":'回复【'+ item.reply.atUserName+'】'},domProps:{\"value\":(item.reply.content)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.$set(item.reply, \"content\", $event.target.value)}}}),_c('el-button',{attrs:{\"type\":\"success\",\"size\":\"mini\"},on:{\"click\":function($event){return _vm.submitSubMessage(index)}}},[_vm._v(\"提交\")])],1)])}),0),_c('div',{staticClass:\"pagination\"},[_c('el-pagination',{attrs:{\"current-page\":_vm.currentPage,\"page-sizes\":[5, 10, 15, 20],\"page-size\":5,\"layout\":\"sizes, prev, pager, next\",\"total\":_vm.total},on:{\"size-change\":_vm.handleSizeChange,\"current-change\":_vm.handleCurrentChange,\"update:currentPage\":function($event){_vm.currentPage=$event},\"update:current-page\":function($event){_vm.currentPage=$event}}})],1)])],1)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"desc\"},[_c('h1',[_vm._v(\"留言板\")]),_c('p',[_vm._v(\"您的建议让网站得到优化！！！\")])])}]\n\nexport { render, staticRenderFns }","import request from './index';\r\n\r\nexport default {\r\n    //添加留言 {userId: ,content}\r\n    addMessage(data){\r\n        return request.post(\"/api/message/addMessage\",data);\r\n    },\r\n    //添加回复留言\r\n    addSubMessage(data) {\r\n        return request.post(\"/api/message/addSubMessage\",data);\r\n    },\r\n    //获取留言数据\r\n    getMessageList(skip=0,limit=5){\r\n        return request.get(\"/api/message/getMessageList\",{params: {skip,limit}});\r\n    },\r\n    //获取留言总条数\r\n    getCountMessage(){\r\n        return request.get(\"/api/message/getCountMessage\");\r\n    }\r\n}","<template>\r\n    <div id=\"message\">\r\n        <Nav></Nav>\r\n        <div class=\"message-main\">\r\n            <div class=\"message-edit\">\r\n                <div class=\"desc\">\r\n                    <h1>留言板</h1>\r\n                    <p>您的建议让网站得到优化！！！</p>\r\n                </div>\r\n                <RichText @Sub=\"submitMessage\" ></RichText>\r\n            </div>\r\n            <ul class=\"message-list\">\r\n                <li class=\"message-item\" v-for=\"(item,index) in commentList\" :key=\"item._id\">\r\n                    <div class=\"p-u-info\">\r\n                        <span class=\"img\" :style=\"{'backgroundImage': 'url('+item.user.avatar+')'}\"></span>\r\n                        <span class=\"user\">{{item.user.username}}</span>\r\n                    </div>\r\n                    <div class=\"content\">\r\n                        <div class=\"text\" v-html=\"item.content\"></div>\r\n                        <div class=\"time\">\r\n                            <span>{{item.date | getTime}}</span>\r\n                            <a href=\"javascript:;\" @click=\"replyClick(index)\">\r\n                                {{(item.reply.lastIndexArr[0]===index && item.reply.lastIndexArr[1]===undefined)?\"收起\":\"回复\"}}\r\n                            </a>\r\n                        </div>\r\n                    </div>\r\n                    <ul class=\"sub-list\">\r\n                        <li class=\"sub-item\" v-for=\"(childItem,childIndex) in item.children\" :key=\"childIndex+Math.random()*100\">\r\n                            <div class=\"img\" :style=\"{'backgroundImage': 'url('+childItem.user.avatar+')'}\"></div>\r\n                            <div class=\"content\">\r\n                                <div>\r\n                                    <span class=\"name\">{{childItem.user.username}}</span>\r\n                                    <span>回复</span>\r\n                                    <span class=\"name\">{{childItem.atUserName}}</span>\r\n                                    <span class=\"content\">{{childItem.content}}</span>\r\n                                </div>\r\n                                <div>\r\n                                    <span class=\"time\">{{childItem.date | getTime}}</span>\r\n                                    <a href=\"javascript:;\" @click=\"replyClick(index,childIndex)\">\r\n                                        {{(item.reply.lastIndexArr[0]===index && item.reply.lastIndexArr[1]===childIndex)?\"收起\":\"回复\"}}\r\n                                    </a>\r\n                                </div>\r\n                            </div>\r\n                        </li>\r\n                    </ul>\r\n                    <div :class=\"['reply',{'show': item.reply.ifShow}]\">\r\n                        <textarea :placeholder=\"'回复【'+ item.reply.atUserName+'】'\" v-model=\"item.reply.content\"></textarea>\r\n                        <el-button type=\"success\" size=\"mini\" @click=\"submitSubMessage(index)\">提交</el-button>\r\n                    </div>\r\n                </li>\r\n            </ul>\r\n            <div class=\"pagination\">\r\n                <el-pagination\r\n                        @size-change=\"handleSizeChange\"\r\n                        @current-change=\"handleCurrentChange\"\r\n                        :current-page.sync=\"currentPage\"\r\n                        :page-sizes=\"[5, 10, 15, 20]\"\r\n                        :page-size=\"5\"\r\n                        layout=\"sizes, prev, pager, next\"\r\n                        :total=\"total\">\r\n                </el-pagination>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n    import Nav from \"../../components/Nav\";\r\n    import RichText from \"../../components/RichText\";\r\n    import userService from \"../../api/userService\";\r\n    import messageService from \"../../api/messageService\";\r\n    export default {\r\n        name: \"index\",\r\n        components: {\r\n            Nav,RichText\r\n        },\r\n        data() {\r\n            return{\r\n                commentList : [],\r\n                currentPage: 1,\r\n                total: 0,\r\n                skip: 0,\r\n                limit: 5\r\n            }\r\n        },\r\n        filters: {\r\n            getTime(value) {\r\n                //2020/4/2 16:31:28\r\n                let date = new Date(value);\r\n                let y = date.getFullYear();\r\n                let m = date.getMinutes() + 1;\r\n                let d = date.getDay();\r\n                let h = date.getHours();\r\n                let M = date.getMinutes();\r\n                let s = date.getSeconds();\r\n                return y + '/' + m + '/' + d + ' ' + h + \":\" + M + \":\" + s;\r\n            }\r\n        },\r\n        methods: {\r\n            submitMessage(value) {\r\n                if (!value){\r\n                    layer.msg('请输入内容', {icon: 2});\r\n                    return false;\r\n                }\r\n                userService.getIfUserLogin().then(res => {\r\n                    let data = res.data;\r\n                    if (!data.ifLogin) {\r\n                        layer.msg('清先登录', {icon: 2});\r\n                    }else{\r\n                        messageService.addMessage({userId: data.data._id, content: value}).then(res => {\r\n                            if (res.data.code === 0){\r\n                                layer.msg('留言成功', {icon: 1});\r\n                                //后续操作\r\n                                // TODO 需要清除内容并且重新获取留言列表，不想刷新整个页面\r\n                                setTimeout(function () {\r\n                                    window.location.reload()\r\n                                },1000)\r\n                            }else{\r\n                                layer.msg(res.data.msg, {icon: 2});\r\n                            }\r\n                        }).catch(err => {\r\n                            layer.msg('服务器错误~请稍后重试', {icon: 2});\r\n                        })\r\n                    }\r\n                });\r\n            },\r\n            submitSubMessage(pIndex){\r\n                //判断是否登录\r\n                userService.getIfUserLogin().then(res => {\r\n                    let data = res.data;\r\n                    if (!data.ifLogin) {\r\n                        layer.msg('清先登录', {icon: 2});\r\n                    }else{\r\n                        messageService.addSubMessage({\r\n                                parentId: this.commentList[pIndex]._id,\r\n                                userId: data.data._id,\r\n                                content: this.commentList[pIndex].reply.content,\r\n                                atUserName: this.commentList[pIndex].reply.atUserName}\r\n                            ).then(res => {\r\n                            if (res.data.code === 0){\r\n                                layer.msg('留言成功', {icon: 1});\r\n                                //后续操作\r\n                                // TODO 需要清除内容并且重新获取留言列表，不想刷新整个页面\r\n                                setTimeout(function () {\r\n                                    window.location.reload()\r\n                                },1000)\r\n                            }else{\r\n                                layer.msg(res.data.msg, {icon: 2});\r\n                            }\r\n                        }).catch(err => {\r\n                            layer.msg('服务器错误~请稍后重试', {icon: 2});\r\n                        })\r\n                    }\r\n                })\r\n            },\r\n            replyClick(pIndex,cIndex){\r\n                if (pIndex === undefined)return;\r\n                let parentData = this.commentList[pIndex];\r\n                //两次点的同一个\r\n                if ((pIndex === parentData.reply.lastIndexArr[0] && cIndex === parentData.reply.lastIndexArr[1])) {\r\n                    parentData.reply.ifShow = false;\r\n                    parentData.reply.lastIndexArr=[];\r\n                }else{\r\n                    //不是同一个\r\n                    parentData.reply.ifShow = true;\r\n                    parentData.reply.lastIndexArr=[pIndex,cIndex];\r\n                }\r\n                if (cIndex === undefined){\r\n                    //不是点的子回复\r\n                    parentData.reply.atUserName = parentData.user.username;\r\n                }else{\r\n                    //点的子回复\r\n                    parentData.reply.atUserName = parentData.children[cIndex].user.username\r\n                }\r\n            },\r\n            //获取列表数据\r\n            getMessageList() {\r\n                messageService.getMessageList(this.skip,this.limit).then(res => {\r\n                    let data = res.data;\r\n                    if (data.code ===0 ){\r\n                        //添加reply\r\n                        if (data.data){\r\n                            this.commentList = data.data.map(item => {\r\n                                item.reply = {\r\n                                    userId : \"\",//id\r\n                                    content : \"\",//回复内容\r\n                                    atUserName : \"\",//字符串\r\n                                    date : \"\",//日期\r\n                                    ifShow : false,\r\n                                    lastIndexArr : []\r\n                                };\r\n                                return item;\r\n                            });\r\n                        }\r\n                    }\r\n                })\r\n            },\r\n            //获取留言总条数\r\n            getCountMessage() {\r\n              messageService.getCountMessage().then(res => {\r\n                  let data = res.data;\r\n                  if (data.code === 0){\r\n                      this.total = data.total;\r\n                  }\r\n              });\r\n            },\r\n            handleSizeChange(size){\r\n                this.limit = size;\r\n                this.skip = (this.currentPage-1)*this.limit;\r\n                this.getMessageList(this.skip,this.limit);\r\n            },\r\n            handleCurrentChange(currentPage){\r\n                this.skip = (currentPage-1)*this.limit;\r\n                this.getMessageList(this.skip,this.limit);\r\n            }\r\n        },\r\n        mounted() {\r\n            this.getMessageList();\r\n            this.getCountMessage();\r\n        }\r\n    }\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n#message{\r\n    width: 100%;\r\n    padding-top: 75px;\r\n    .message-main{\r\n        max-width: 1360px;\r\n        box-sizing: border-box;\r\n        width: 100%;\r\n        padding: 0 20px;\r\n        margin: 0 auto;\r\n        > .message-edit{\r\n            box-sizing: border-box;\r\n            width: 100%;\r\n            padding: 20px 10px 30px;\r\n            background-color: #fff;\r\n            border-radius: 2px;\r\n            margin-bottom: 20px;\r\n            > .desc{\r\n                width: 100%;\r\n                height: 100px;\r\n                h1{\r\n                    font-weight: 500;\r\n                    text-align: center;\r\n                    margin-bottom: 10px;\r\n                }\r\n                p{\r\n                    text-align: center;\r\n                    font-size: 15px;\r\n                }\r\n            }\r\n        }\r\n        > ul.message-list{\r\n            width: 100%;\r\n            padding: 20px 15px;\r\n            box-sizing: border-box;\r\n            background-color: #fff;\r\n            > li.message-item{\r\n                box-sizing: border-box;\r\n                width: 100%;\r\n                padding: 10px 0 0 50px;\r\n                border-bottom: 1px dashed #eee;\r\n                overflow: hidden;\r\n                >div.p-u-info{\r\n                    position: relative;\r\n                    left: -50px;\r\n                    height: 40px;\r\n                    line-height: 40px;\r\n                    width: 100%;\r\n                    span.img{\r\n                        display: inline-block;\r\n                        width: 40px;\r\n                        height: 40px;\r\n                        border-radius: 50%;\r\n                        background-size: cover;\r\n                        vertical-align: middle;\r\n                    }\r\n                    span.user{\r\n                        display: inline-block;\r\n                        height: 40px;\r\n                        line-height: 40px;\r\n                        vertical-align: middle;\r\n                        margin-left: 10px;\r\n                    }\r\n                }\r\n                >div.content{\r\n                    width: 100%;\r\n                    box-sizing: border-box;\r\n                    padding: 8px 0;\r\n                    .time{\r\n                        padding: 2px 10px;\r\n                        color: #7a7374;\r\n                        a{\r\n                            color: #00FFFF;\r\n                            margin-left: 10px;\r\n                        }\r\n                    }\r\n                }\r\n                >ul.sub-list{\r\n                    border-top: 1px solid #eee;\r\n                    box-sizing: border-box;\r\n                    width: 100%;\r\n                    > li.sub-item{\r\n                        width: 100%;\r\n                        padding: 10px 0;\r\n                        display: flex;\r\n                        div.img{\r\n                            width: 40px;\r\n                            height: 40px;\r\n                            border-radius: 50%;\r\n                            background-size: cover;\r\n                            margin-right: 10px;\r\n                        }\r\n                        div.content{\r\n                            div:nth-child(1){\r\n                                span.name{\r\n                                    color: #31BAF0;\r\n                                }\r\n                                span:nth-child(2){\r\n                                    margin: 0 10px;\r\n                                }\r\n                                span:nth-child(4){\r\n                                    margin-left: 15px;\r\n                                }\r\n                            }\r\n                            div:nth-child(2){\r\n                                span.time{\r\n                                    color: #7a7374;\r\n                                    font-size: 12px;\r\n                                    margin: 0 10px 0 7px;\r\n                                }\r\n                                a{\r\n                                    color: #00FFFF;\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                >div.reply{\r\n                    width: 100%;\r\n                    height: 0;\r\n                    transition: height .3s;\r\n                    &.show{\r\n                        height: 110px;\r\n                    }\r\n                    textarea{\r\n                        box-sizing: border-box;\r\n                        padding: 10px;\r\n                        width: 100%;\r\n                        height: 60px;\r\n                        display: block;\r\n                        margin-bottom: 10px;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        > .pagination{\r\n            width: 100%;\r\n            height: 30px;\r\n            line-height: 30px;\r\n            text-align: center;\r\n            padding: 20px 0;\r\n        }\r\n    }\r\n}\r\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=be574686&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=be574686&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"be574686\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('textarea',{staticStyle:{\"display\":\"none\"},attrs:{\"id\":\"richText\"}}),_c('el-button',{staticStyle:{\"margin-top\":\"10px\"},attrs:{\"type\":\"primary\"},on:{\"click\":_vm.handleSubmit}},[_vm._v(\"提交留言\")])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n    <div>\r\n        <textarea id=\"richText\" style=\"display: none;\"></textarea>\r\n        <el-button type=\"primary\" style=\"margin-top: 10px\" @click=\"handleSubmit\">提交留言</el-button>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n    export default {\r\n        name: \"RichText\",\r\n        data() {\r\n            return {\r\n                layedit: null,\r\n                index: 0\r\n            }\r\n        },\r\n        methods: {\r\n            handleSubmit() {\r\n                this.$emit('Sub',this.layedit.getContent(this.index));\r\n            }\r\n        },\r\n        mounted() {\r\n            layui.use('layedit', () => {\r\n                this.layedit = layui.layedit;\r\n                this.index = this.layedit.build('richText',{\r\n                    tool: ['face'],\r\n                    height: 150\r\n                }); //建立编辑器\r\n            });\r\n        }\r\n    }\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./RichText.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./RichText.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./RichText.vue?vue&type=template&id=2ad26fc7&scoped=true&\"\nimport script from \"./RichText.vue?vue&type=script&lang=js&\"\nexport * from \"./RichText.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"2ad26fc7\",\n  null\n  \n)\n\nexport default component.exports","'use strict';\nvar $ = require('../internals/export');\nvar $map = require('../internals/array-iteration').map;\nvar arrayMethodHasSpeciesSupport = require('../internals/array-method-has-species-support');\nvar arrayMethodUsesToLength = require('../internals/array-method-uses-to-length');\n\nvar HAS_SPECIES_SUPPORT = arrayMethodHasSpeciesSupport('map');\n// FF49- issue\nvar USES_TO_LENGTH = arrayMethodUsesToLength('map');\n\n// `Array.prototype.map` method\n// https://tc39.github.io/ecma262/#sec-array.prototype.map\n// with adding support of @@species\n$({ target: 'Array', proto: true, forced: !HAS_SPECIES_SUPPORT || !USES_TO_LENGTH }, {\n  map: function map(callbackfn /* , thisArg */) {\n    return $map(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n"],"sourceRoot":""}